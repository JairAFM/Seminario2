CREATE DATABASE dbRestaurantes;
USE dbRestaurantes;

CREATE TABLE Puestos (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Descripcion VARCHAR(255) NOT NULL
);

CREATE TABLE Imagenes (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Nombre VARCHAR(255),
    Tipo VARCHAR(50),
    Imagen LONGBLOB
);

CREATE TABLE Clientes (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Email VARCHAR(255) NOT NULL,
    Nombres VARCHAR(255) NOT NULL,
    Apellidos VARCHAR(255) NOT NULL,
    Telefono BIGINT,
    Password VARCHAR(255) NOT NULL,
    FechaCreacion DATETIME NOT NULL,
    FechaActualizacion DATETIME NOT NULL
);

CREATE TABLE Categoria (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Descripcion VARCHAR(255) NOT NULL
);

CREATE TABLE Estados (
    Id INT PRIMARY KEY,
    Descripcion VARCHAR(255) NOT NULL,
    Capacidad INT NOT NULL
);

CREATE TABLE Empleados (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Email VARCHAR(255) NOT NULL,
    Nombres VARCHAR(255) NOT NULL,
    Apellidos VARCHAR(255) NOT NULL,
    Telefono BIGINT,
    Id_Puesto INT,
    Salario DECIMAL(10, 2) NOT NULL,
    Usuario VARCHAR(255) NOT NULL,
    Password VARCHAR(255) NOT NULL,
    Id_Imagen INT,
    FechaCreacion DATETIME NOT NULL,
    FechaActualizacion DATETIME NOT NULL,
    FOREIGN KEY (Id_Puesto) REFERENCES Puestos(Id),
    FOREIGN KEY (Id_Imagen) REFERENCES Imagenes(Id)
);

CREATE TABLE Menu (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Titulo VARCHAR(255) NOT NULL,
    Descripcion VARCHAR(255) NOT NULL,
    Precio DECIMAL(10, 2) NOT NULL,
    Id_Categoria INT,
    FOREIGN KEY (Id_Categoria) REFERENCES Categoria(Id)
);

CREATE TABLE Menu_Imgenes (
    Id_Menu INT NOT NULL,
    Id_Imagen INT NOT NULL,
    PRIMARY KEY(Id_Menu, Id_Imagen)
);

CREATE TABLE Mesas (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Id_Mesa INT NOT NULL,
    Capacidad INT NOT NULL
);

CREATE TABLE Restaurante (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Direccion VARCHAR(255) NOT NULL,
    Telefono BIGINT NOT NULL,
    FechaCreacion DATETIME NOT NULL,
    FechaActualizacion DATETIME NOT NULL
);

CREATE TABLE Ordenes (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Id_Restaurante INT,
    Id_Cliente INT,
    Id_Empleado INT,
    Id_Mesa INT,
    Tipo VARCHAR(50),
    Fecha DATETIME NOT NULL,
    Total DECIMAL(10, 2) NOT NULL,
    FOREIGN KEY (Id_Restaurante) REFERENCES Restaurante(Id),
    FOREIGN KEY (Id_Cliente) REFERENCES Clientes(Id),
    FOREIGN KEY (Id_Empleado) REFERENCES Empleados(Id),
    FOREIGN KEY (Id_Mesa) REFERENCES Mesas(Id)
);

CREATE TABLE Orden_Detalle (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Id_Orden INT,
    Id_Menu INT,
    Cantidad DECIMAL(10, 2) NOT NULL,
    Precio DECIMAL(10, 2) NOT NULL,
    FOREIGN KEY (Id_Orden) REFERENCES Ordenes(Id),
    FOREIGN KEY (Id_Menu) REFERENCES Menu(Id)
);

CREATE TABLE Reservaciones (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Id_Cliente INT,
    Id_Orden INT,
    Fecha DATETIME NOT NULL,
    No_Personas INT NOT NULL,
    Id_Estado INT,
    FOREIGN KEY (Id_Cliente) REFERENCES Clientes(Id),
    FOREIGN KEY (Id_Orden) REFERENCES Ordenes(Id),
    FOREIGN KEY (Id_Estado) REFERENCES Estados(Id)
);
